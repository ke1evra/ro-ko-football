# Инструкция по развертыванию проекта

Этот документ описывает, как развернуть проект с помощью Docker на машине, где уже установлены все необходимые зависимости.

## Предварительные требования

1.  **Git**: Установлен и настроен.
2.  **Docker и Docker Compose**: Установлены и запущены. [Инструкция по установке Docker](https://docs.docker.com/engine/install/).
3.  **База данных MongoDB**: Запущена и доступна для подключения.

## Шаги развертывания

### 1. Клонирование репозитория

Склонируйте репозиторий на ваш локальный компьютер или сервер:

```bash
git clone <URL_вашего_репозитория>
cd payload-starter
```

### 2. Настройка файла окружения (`.env`)

Создайте копию файла с примером переменных окружения:

```bash
cp .env.example .env
```

Откройте файл `.env` в текстовом редакторе и заполните его, уделив особое внимание следующим переменным:

-   `DATABASE_URI`: Строка подключения к вашей базе данных MongoDB.
    -   **Для Docker на Mac/Windows**: Используйте `host.docker.internal` вместо `localhost` или `127.0.0.1`, чтобы контейнер мог подключиться к базе данных на вашем компьютере.
    -   **Для Docker на Linux**: Вы можете использовать `127.0.0.1`.

    **Пример для Docker на Mac/Windows:**
    ```env
    DATABASE_URI="mongodb://USER:PASSWORD@host.docker.internal:27017/DATABASE_NAME?authSource=admin"
    ```

-   `PAYLOAD_SECRET`: Сгенерируйте надежный секретный ключ. Можете использовать `openssl rand -hex 32` или любой другой генератор случайных строк.

-   `APP_URL`: URL, по которому будет доступно ваше приложение (например, `http://localhost:3100`).

### 3. Сборка и запуск контейнера

Находясь в корневой папке проекта, выполните команду:

```bash
docker compose up --build -d
```

-   `--build`: Эта опция заставит Docker пересобрать образ, если в `Dockerfile` или файлах проекта были изменения.
-   `-d`: Запускает контейнер в фоновом режиме (detached mode).

### 4. Проверка статуса

Чтобы убедиться, что контейнер успешно запустился, выполните:

```bash
docker compose ps
```

Вы должны увидеть, что сервис `app` находится в состоянии `Up`.

Чтобы посмотреть логи приложения в реальном времени и отследить возможные ошибки, используйте команду:

```bash
docker compose logs --follow app
```

### 5. Доступ к приложению

После успешного запуска приложение будет доступно в вашем браузере по адресу, указанному в переменной `APP_URL` (например, `http://localhost:3100`).
